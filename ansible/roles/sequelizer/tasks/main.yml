---
- name: Copy sequelizer
  synchronize: src=/Users/ryan/projects/outins/sequelizer dest={{ tcql.dest_dir }}

- name: fix permissions on sequelizer
  file: path={{ tcql.dest_dir }}/sequelizer recurse=yes owner={{ tcql.user }} group={{ tcql.group }}
  sudo: yes

- name: Install bundler
  command: bash -lc 'bundle --version || gem install bundler'
  register: _cql_install_bundler
  changed_when: _cql_install_bundler.stdout.find('fully installed') != -1

- name: Install gems via bundler
  command: bash -lc "cd {{ sequelizer_dir }} && bundle"
  register: _cql_install_gems_via_bundler
  changed_when: _cql_install_gems_via_bundler.stdout.find('Installing') != -1
